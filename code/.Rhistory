scale_x_continuous(name = "Longitude", breaks = seq(-180, 180, 60)) +
scale_y_continuous(name = "Latitude", breaks = seq(-90, 90, 45)) +
scale_color_distiller("Press", palette = "Spectral") +
facet_grid(basin~season, ) +
coord_equal(xlim = c(-180, 20)) +
ggtitle("Trajectories of storms in East Pacific") +
theme_bw() +
theme(plot.title = element_text(hjust = 0.5)) +
theme(legend.spacing.x = unit(1,"mm"),
legend.key.width = unit(2.5, "mm"),
legend.key.height = unit(10, "mm"),
legend.background = element_blank(),
legend.key = element_rect(size = 0))
p_EP
## basins EP by year
ibt_vis <- ibt[ibt$basin %in% c("EP", "NA"), ]
p_EPNA <-
ggplot() +
geom_polygon(data = wmap, aes(x = long, y = lat, group = group),
fill = "whitesmoke", colour = "gray50", size = 0.1) +
geom_path(aes(x = longitude, y = latitude, group = serial_num,
color = press),
data = ibt_vis, size = 0.6) +
scale_x_continuous(name = "Longitude", breaks = seq(-180, 180, 60)) +
scale_y_continuous(name = "Latitude", breaks = seq(-90, 90, 45)) +
scale_color_distiller("Press", palette = "Spectral") +
facet_grid(basin~season, ) +
coord_equal(xlim = c(-180, 20)) +
ggtitle("Trajectories of storms in East Pacific") +
theme_bw() +
theme(plot.title = element_text(hjust = 0.5)) +
theme(legend.spacing.x = unit(1,"mm"),
legend.position = c("bottom"),
legend.key.width = unit(12, "mm"),
legend.key.height = unit(2.5, "mm"),
legend.background = element_blank(),
legend.key = element_rect(size = 0))
p_EPNA
p_EPNA <-
ggplot() +
geom_polygon(data = wmap, aes(x = long, y = lat, group = group),
fill = "whitesmoke", colour = "gray50", size = 0.1) +
geom_path(aes(x = longitude, y = latitude, group = serial_num,
color = press),
data = ibt_vis, size = 0.6) +
scale_x_continuous(name = "Longitude", breaks = seq(-180, 180, 60)) +
scale_y_continuous(name = "Latitude", breaks = seq(-90, 90, 45)) +
scale_color_distiller("Press", palette = "Spectral") +
facet_grid(basin~season, ) +
coord_equal(xlim = c(-180, 20), ylim = c(-10, 80)) +
ggtitle("Trajectories of storms in East Pacific") +
theme_bw() +
theme(plot.title = element_text(hjust = 0.5)) +
theme(legend.spacing.x = unit(1,"mm"),
legend.position = c("bottom"),
legend.key.width = unit(12, "mm"),
legend.key.height = unit(2.5, "mm"),
legend.background = element_blank(),
legend.key = element_rect(size = 0))
p_EPNA
p_EPNA <-
ggplot() +
geom_polygon(data = wmap, aes(x = long, y = lat, group = group),
fill = "whitesmoke", colour = "gray50", size = 0.1) +
geom_path(aes(x = longitude, y = latitude, group = serial_num,
color = press),
data = ibt_vis, size = 0.6) +
scale_x_continuous(name = "Longitude", breaks = seq(-180, 180, 60)) +
scale_y_continuous(name = "Latitude", breaks = seq(-90, 90, 45)) +
scale_color_distiller("Press", palette = "Spectral") +
facet_grid(season~basin, ) +
coord_equal(xlim = c(-180, 20), ylim = c(-10, 80)) +
ggtitle("Trajectories of storms in East Pacific") +
theme_bw() +
theme(plot.title = element_text(hjust = 0.5)) +
theme(legend.spacing.x = unit(1,"mm"),
legend.position = c("bottom"),
legend.key.width = unit(12, "mm"),
legend.key.height = unit(2.5, "mm"),
legend.background = element_blank(),
legend.key = element_rect(size = 0))
p_EPNA
p_EPNA <-
ggplot() +
geom_polygon(data = wmap, aes(x = long, y = lat, group = group),
fill = "whitesmoke", colour = "gray50", size = 0.1) +
geom_path(aes(x = longitude, y = latitude, group = serial_num,
color = press),
data = ibt_vis, size = 0.6) +
scale_x_continuous(name = "Longitude", breaks = seq(-180, 180, 60)) +
scale_y_continuous(name = "Latitude", breaks = seq(-90, 90, 45)) +
scale_color_distiller("Press", palette = "Spectral") +
facet_grid(season~basin, ) +
coord_equal(xlim = c(-180, 20), ylim = c(-10, 80)) +
ggtitle("Trajectories of storms in East Pacific") +
theme_bw() +
theme(plot.title = element_text(hjust = 0.5)) +
theme(legend.spacing.x = unit(1,"mm"),
legend.key.width = unit(2.5, "mm"),
legend.key.height = unit(12, "mm"),
legend.background = element_blank(),
legend.key = element_rect(size = 0))
p_EPNA
## basins EP by year
ibt_vis <- ibt[ibt$basin %in% c("EP", "NA"), ]
p_EPNA <-
ggplot() +
geom_polygon(data = wmap, aes(x = long, y = lat, group = group),
fill = "whitesmoke", colour = "gray50", size = 0.1) +
geom_path(aes(x = longitude, y = latitude, group = serial_num,
color = press),
data = ibt_vis, size = 0.6) +
scale_x_continuous(name = "Longitude", breaks = seq(-180, 180, 60)) +
scale_y_continuous(name = "Latitude", breaks = seq(-90, 90, 45)) +
scale_color_distiller("Press", palette = "Spectral") +
facet_grid(season~basin, ) +
coord_equal(xlim = c(-180, 20), ylim = c(-10, 80)) +
ggtitle("Trajectories of storms in East Pacific") +
theme_bw() +
theme(plot.title = element_text(hjust = 0.5)) +
theme(legend.spacing.x = unit(1,"mm"),
legend.position = c("right"),
legend.key.width = unit(2.5, "mm"),
legend.key.height = unit(16, "mm"),
legend.background = element_blank(),
legend.key = element_rect(size = 0))
p_EPNA
width <- 6.75 # in
p_EPNA <-
ggplot() +
geom_polygon(data = wmap, aes(x = long, y = lat, group = group),
fill = "whitesmoke", colour = "gray50", size = 0.1) +
geom_path(aes(x = longitude, y = latitude, group = serial_num,
color = press),
data = ibt_vis, size = 0.6) +
scale_x_continuous(name = "Longitude", breaks = seq(-180, 180, 60)) +
scale_y_continuous(name = "Latitude", breaks = seq(-90, 90, 45)) +
scale_color_distiller("Press", palette = "Spectral") +
facet_grid(season~basin, ) +
coord_equal(xlim = c(-180, 20), ylim = c(-10, 80)) +
ggtitle("Trajectories of storms in East Pacific") +
theme_bw() +
theme(plot.title = element_text(hjust = 0.5)) +
theme(legend.spacing.x = unit(1,"mm"),
legend.position = c("left"),
legend.key.width = unit(2.5, "mm"),
legend.key.height = unit(16, "mm"),
legend.background = element_blank(),
legend.key = element_rect(size = 0))
width <- 6.75 # in
height <- 8
pdf(file = "../images/map-ep-na-storms-by-year.pdf",
width = width, height = height)
p_EPNA
dev.off()
png(filename = "../images/map-ep-na-storms-by-year.png",
width = width, height = height, units = "in", res = 135)
p_EPNA
dev.off()
## basin EP NA by month
ibt_vis <- ibt[ibt$basin %in% c("EP", "NA"), ]
ibt_vis$iso_time
library(lubridate)
a <- lubridate::as_date(ibt_vis)
a <- lubridate::as_date(ibt_vis$iso_time)
month(a)
## basin EP NA by month
ibt_vis <- ibt[ibt$basin %in% c("EP", "NA"), ]
ibt_vis$month <- month(as_date(ibt_vis$iso_time))
ibt_vis$month
unique(ibt_vis$month)
?scale_color_distiller
## basin EP NA by month
ibt_vis <- ibt[ibt$basin %in% c("EP", "NA"), ]
ibt_vis$month <- month(as_date(ibt_vis$iso_time))
p_EPNA_m <-
ggplot() +
geom_polygon(data = wmap, aes(x = long, y = lat, group = group),
fill = "whitesmoke", colour = "gray50", size = 0.1) +
geom_path(aes(x = longitude, y = latitude, group = serial_num,
color = wind),
data = ibt_vis, size = 0.6) +
scale_x_continuous(name = "Longitude", breaks = seq(-180, 180, 60)) +
scale_y_continuous(name = "Latitude", breaks = seq(-90, 90, 45)) +
scale_color_distiller("Wind", palette = "BuPu") +
facet_grid(month~basin, ) +
coord_equal(xlim = c(-180, 20), ylim = c(-10, 80)) +
ggtitle("Trajectories of storms in East Pacific") +
theme_bw() +
theme(plot.title = element_text(hjust = 0.5)) +
theme(legend.spacing.x = unit(1,"mm"),
legend.position = c("left"),
legend.key.width = unit(2.5, "mm"),
legend.key.height = unit(16, "mm"),
legend.background = element_blank(),
legend.key = element_rect(size = 0))
p_EPNA_m
width <- 6.75 # in
height <- 12
pdf(file = "../images/map-ep-na-storms-by-month.pdf",
width = width, height = height)
p_EPNA_m
dev.off()
p_EPNA_m <-
ggplot() +
geom_polygon(data = wmap, aes(x = long, y = lat, group = group),
fill = "whitesmoke", colour = "gray50", size = 0.1) +
geom_path(aes(x = longitude, y = latitude, group = serial_num,
color = wind),
data = ibt_vis, size = 0.6) +
scale_x_continuous(name = "Longitude", breaks = seq(-180, 180, 60)) +
scale_y_continuous(name = "Latitude", breaks = seq(-90, 90, 45)) +
scale_color_distiller("Wind", palette = "Blues") +
facet_grid(month~basin, ) +
coord_equal(xlim = c(-180, 20), ylim = c(-10, 80)) +
ggtitle("Trajectories of storms in East Pacific") +
theme_bw() +
theme(plot.title = element_text(hjust = 0.5)) +
theme(legend.spacing.x = unit(1,"mm"),
legend.position = c("left"),
legend.key.width = unit(2.5, "mm"),
legend.key.height = unit(16, "mm"),
legend.background = element_blank(),
legend.key = element_rect(size = 0))
width <- 6.75 # in
height <- 12
pdf(file = "../images/map-ep-na-storms-by-month.pdf",
width = width, height = height)
p_EPNA_m
dev.off()
png(filename = "../images/map-ep-na-storms-by-month.png",
width = width, height = height, units = "in", res = 135)
p_EPNA
dev.off()
png(filename = "../images/map-ep-na-storms-by-month.png",
width = width, height = height, units = "in", res = 135)
p_EPNA_m
dev.off()
p_EPNA_m <-
ggplot() +
geom_polygon(data = wmap, aes(x = long, y = lat, group = group),
fill = "whitesmoke", colour = "gray50", size = 0.1) +
geom_path(aes(x = longitude, y = latitude, group = serial_num,
color = wind),
data = ibt_vis, size = 0.6) +
scale_x_continuous(name = "Longitude", breaks = seq(-180, 180, 60)) +
scale_y_continuous(name = "Latitude", breaks = seq(-90, 90, 45)) +
scale_color_distiller("Wind", palette = "BuPu", direction = -1) +
facet_grid(month~basin, ) +
coord_equal(xlim = c(-180, 20), ylim = c(-10, 80)) +
ggtitle("Trajectories of storms in East Pacific") +
theme_bw() +
theme(plot.title = element_text(hjust = 0.5)) +
theme(legend.spacing.x = unit(1,"mm"),
legend.position = c("left"),
legend.key.width = unit(2.5, "mm"),
legend.key.height = unit(16, "mm"),
legend.background = element_blank(),
legend.key = element_rect(size = 0))
p_EPNA_m
width <- 6.75 # in
height <- 12
pdf(file = "../images/map-ep-na-storms-by-month.pdf",
width = width, height = height)
p_EPNA_m
dev.off()
png(filename = "../images/map-ep-na-storms-by-month.png",
width = width, height = height, units = "in", res = 135)
p_EPNA_m
dev.off()
p_EPNA_m <-
ggplot() +
geom_polygon(data = wmap, aes(x = long, y = lat, group = group),
fill = "whitesmoke", colour = "gray50", size = 0.1) +
geom_path(aes(x = longitude, y = latitude, group = serial_num,
color = wind),
data = ibt_vis, size = 0.6) +
scale_x_continuous(name = "Longitude", breaks = seq(-180, 180, 60)) +
scale_y_continuous(name = "Latitude", breaks = seq(-90, 90, 45)) +
scale_color_distiller("Wind", palette = "BuPu", direction = 1) +
facet_grid(month~basin, ) +
coord_equal(xlim = c(-180, 20), ylim = c(-10, 80)) +
ggtitle("Trajectories of storms in East Pacific") +
theme_bw() +
theme(plot.title = element_text(hjust = 0.5)) +
theme(legend.spacing.x = unit(1,"mm"),
legend.position = c("left"),
legend.key.width = unit(2.5, "mm"),
legend.key.height = unit(16, "mm"),
legend.background = element_blank(),
legend.key = element_rect(size = 0))
p_EPNA_m
width <- 6.75 # in
height <- 12
pdf(file = "../images/map-ep-na-storms-by-month.pdf",
width = width, height = height)
p_EPNA_m
dev.off()
png(filename = "../images/map-ep-na-storms-by-month.png",
width = width, height = height, units = "in", res = 135)
p_EPNA_m
dev.off()
ibt
ls()
ibt %>%
group_by(serial_num) %>%
count()
ibt %>%
group_by(year) %>%
distinct(serial_num)
ibt %>%
group_by(season) %>%
distinct(serial_num)
ibt %>%
group_by(season) %>%
distinct(serial_num) %>%
count()
a <- data.frame(x = c(1,1,2,1,2,3,3), y = c(2011,2011,2011,2012,2012,2012,2012))
a
a %>% group_by(y) %>
a %>%
group_by(y) %>%
distinct(x) %>%
count()
a
a %>%
group_by(y > 2010) %>%
distinct(x) %>%
count()
a %>%
group_by(y < 2012) %>%
distinct(x) %>%
count()
ibt %>%
group_by(season) %>%
distinct(serial_num) %>%
count()
ibt %>%
group_by(latitude >= 0) %>%
distinct(serial_num) %>%
count()
ibt$month <- month(as_date(ibt$iso_time))
ibt %>%
group_by(month) %>%
distinct(serial_num) %>%
count()
ibt %>%
group_by(basin) %>%
distinct(serial_num) %>%
count()
ibt$date <- lubridate::as_datetime(ibt$iso_time)
ibt %>%
group_by(serial_num) %>%
range(date)
ibt$date <- lubridate::as_datetime(ibt$iso_time)
ibt
ibt$date
ibt %>%
group_by(serial_num) %>%
duration(date)
ibt$date <- lubridate::as_date(ibt$iso_time)
ibt %>%
group_by(serial_num) %>%
duration(date)
?duration
ibt$date <- lubridate::as_date(ibt$iso_time)
ibt %>%
group_by(serial_num) %>%
mutate(dur = max(date) - min(date))
a <- ibt %>%
group_by(serial_num) %>%
mutate(dur = max(date) - min(date))
a$dur
ibt$date <- lubridate::as_datetime(ibt$iso_time)
a <- ibt %>%
group_by(serial_num) %>%
mutate(dur = max(date) - min(date))
a$date
a$dur
a <- ibt %>%
group_by(serial_num) %>%
mutate(dur = (max(date) - min(date)) /3600)
a$dur
ibt$date <- lubridate::as_date(ibt$iso_time)
ibt %>%
group_by(serial_num) %>%
mutate(dur = max(date) - min(date)) %>%
summarise(dur)
ibt %>%
group_by(serial_num) %>%
mutate(dur = max(date) - min(date))
ans <- ibt %>%
group_by(serial_num) %>%
mutate(dur = max(date) - min(date))
summarise(ans$dur)
summary(ans$dur)
ans$dur
mean(ans$dur)
fivenum(ans$dur)
summarise_(ans$dur)
ibt$date <- lubridate::as_date(ibt$iso_time)
ans <- ibt %>%
group_by(serial_num) %>%
mutate(dur = as.numeric(max(date) - min(date))) %>%
summarise(dur)
ans$dur
is.vector(ans$dur)
class(ans$dur)
as.vector(ans$dur)
ans <- ibt %>%
group_by(serial_num) %>%
mutate(dur = as.vector(max(date) - min(date))) %>%
summarise(dur)
ibt$date <- lubridate::as_date(ibt$iso_time)
ans <- ibt %>%
group_by(serial_num) %>%
mutate(dur = as.integer(max(date) - min(date))) %>%
summarise(dur)
ibt$date <- lubridate::as_date(ibt$iso_time)
ans <- ibt %>%
group_by(serial_num) %>%
mutate(dur = max(date) - min(date))
summarise(as.numeric(ans$dur))
summarise(as.vector(ans$dur))
duration(ans$dur)
ans <- ibt %>%
group_by(serial_num) %>%
mutate(dur = max(date) - min(date))
ans
as.numeric(ans$dur, units="days")
ans <- ibt %>%
group_by(serial_num) %>%
mutate(dur = as.numeric(max(date) - min(date), units = "days")) %>%
summarise(dur)
ans <- ibt %>%
group_by(serial_num) %>%
mutate(dur = as.numeric(max(date) - min(date), units = "days"))
ans
summary(ans$dur)
ggplot(data = ans) +
geom_histogram(aes(x = dur))
ggplot(data = ans) +
geom_histogram(aes(x = dur), bins = 20)
ggplot(data = ans) +
geom_histogram(aes(x = dur), bins = 20) +
xlab("Days") + ylab("Frequency") +
ggtitle("Distribution of storms duration")
ggplot(data = ans) +
geom_histogram(aes(x = dur), bins = 20) +
xlab("Days") + ylab("Frequency") +
ggtitle("Distribution of storms duration") +
theme(plot.title = element_text(hjust = 0.5))
a <- ibt %>%
group_by(serial_num) %>%
mutate(max_speed = max(wind))
a
a
a <- ibt %>%
select(serial_num, wind) %>%
group_by(serial_num) %>%
mutate(max_speed = max(wind))
dim()
dim(a)
a
a <- ibt %>%
select(serial_num, wind) %>%
group_by(serial_num) %>%
distinct(serial_num) %>%
mutate(max_speed = max(wind))
a <- ibt %>%
select(serial_num, wind) %>%
group_by(serial_num) %>%
distinct(serial_num)
a
a <- ibt %>%
select(serial_num, wind) %>%
group_by(serial_num) %>%
mutate(max_speed = max(wind))
a <- ibt %>%
select(serial_num, wind) %>%
group_by(serial_num) %>%
mutate(max_speed = max(wind)) %>%
distinct()
dim(a)
a
a <- ibt %>%
select(serial_num, wind) %>%
group_by(serial_num) %>%
mutate(max_speed = max(wind)) %>%
select(serial_num, max_speed) %>%
distinct()
dim(a)
a
a <- ibt %>%
select(serial_num, wind) %>%
group_by(serial_num) %>%
mutate(max_speed = max(wind)) %>%
select(serial_num, max_speed) %>%
distinct() %>%
arrange(max_speed)
a
?arrange
arrange(desc(max_speed)
a
a <- ibt %>%
select(serial_num, wind) %>%
group_by(serial_num) %>%
mutate(max_speed = max(wind)) %>%
select(serial_num, max_speed) %>%
distinct() %>%
arrange(desc(max_speed))
a
